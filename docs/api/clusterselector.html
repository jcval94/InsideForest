---
layout: default
title: Cluster selector helpers
parent: InsideForest
nav_order: 56
---

<h1>Cluster selector helpers</h1>
<p>The <code>InsideForest.cluster_selector</code> module exposes utilities that rebalance or consolidate clusters produced by <code>Regions.labels</code>. Instead of a single <code>ClusterSelector</code> class, use the dedicated functions and classes described below.</p>

<h2>Key utilities</h2>
<ul>
  <li><code>balance_lists_n_clusters(df_reres, seed=None)</code>: returns consolidated labels after enforcing similar cluster sizes.</li>
  <li><code>max_prob_clusters(df_reres)</code>: favors the clusters with highest probability per record.</li>
  <li><code>match_class_distribution(df_reres, y)</code>: adjusts assignments to mirror the original class distribution.</li>
  <li><code>MenuClusterSelector(quota=0.0, seed=None)</code>: fits a menu of candidate clusters and selects the best configuration according to information-theoretic scores.</li>
  <li><code>ChimeraValuesSelector(quota=0.0, seed=None)</code>: combines silhouettes and quota enforcement to smooth assignments.</li>
</ul>

<h2>Example</h2>
<pre><code class="language-python">from InsideForest import cluster_selector

# After calling InsideForestClassifier(..., get_detail=True).fit(X, y)
menu = cluster_selector.MenuClusterSelector(quota=0.2)
menu.fit(clf.df_reres_, y)
rebalanced = menu.predict(clf.df_reres_)

# Alternatively apply a functional helper
balanced = cluster_selector.balance_lists_n_clusters(clf.df_reres_, seed=42)
</code></pre>

<p>All helpers operate on the DataFrame returned by <code>Regions.prio_ranges</code>, which is stored as <code>df_reres_</code> inside the high-level wrappers when <code>get_detail=True</code>.</p>
